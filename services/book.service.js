import { utilService } from './util.service.js'
import { storageService } from './async-storage.service.js'

const BOOK_KEY = 'bookDB'

_createBooks()

export const bookService = {
    query,
    get,
    remove,
    save,
    getEmptyBook,
    getDefaultFilter,
    createBook,
}

function query(filterBy = {}) {
    return storageService.query(BOOK_KEY)
        .then(books => {
            // Filter by text in title
            if (filterBy.txt) {
                const regExp = new RegExp(filterBy.txt, 'i')
                books = books.filter(book => regExp.test(book.title))
            }
            // Filter by minimum price
            if (filterBy.minPrice) {
                books = books.filter(book => book.listPrice.amount >= filterBy.minPrice)
            }
            // Filter by maximum price
            if (filterBy.maxPrice) {
                books = books.filter(book => book.listPrice.amount <= filterBy.maxPrice)
            }
            // Filter by selected language
            if (filterBy.language) {
                books = books.filter(book => book.language === filterBy.language)
            }
            // Filter by books published before a certain year
            if (filterBy.publishedBefore) {
                books = books.filter(book => book.publishedDate <= filterBy.publishedBefore)
            }
            // Filter by books published after a certain year
            if (filterBy.publishedAfter) {
                books = books.filter(book => book.publishedDate >= filterBy.publishedAfter)
            }
            // Filter by selected categories
            if (filterBy.category) {
                books = books.filter(book => book.categories.includes(filterBy.category));
            }
            return books
        })
}

function get(bookId) {
    return storageService.get(BOOK_KEY, bookId)
}

function remove(bookId) {
    return storageService.remove(BOOK_KEY, bookId)
}

function save(book) {
    if (book.id) return storageService.put(BOOK_KEY, book)
    else return storageService.post(BOOK_KEY, book)
}

function getEmptyBook() {
    return {
        id: '',
        title: '',
        subtitle: '',
        authors: [],
        publishedDate: new Date().getFullYear(),
        description: '',
        pageCount: 0,
        categories: [],
        thumbnail: '',
        language: 'en',
        listPrice: {
            amount: 0,
            currencyCode: 'USD',
            isOnSale: false
        }
    }
}

function getDefaultFilter() {
    return {
        txt: '',
        minPageCount: ''
    }
}

function _createBooks() {
    let books = utilService.loadFromStorage(BOOK_KEY);
    if (!books || !books.length) {
        books = [
            {
                "id": "OXeMG8wNskc",
                "title": "Akarnae",
                "subtitle": "The Medoran Chornicles Begin",
                "authors": [
                    "Lynette Noni"
                ],
                "publishedDate": 2015,
                "description": "Akarnae follows the story of Alex Jennings, a girl who finds herself transported to the magical world of Medora and attends Akarnae Academy for training individuals with extraordinary abilities.",
                "pageCount": 430,
                "categories": [
                    "Fantasy",
                    "Supernatural",
                    "Adventure"
                ],
                "thumbnail": "20",
                "language": "en",
                "listPrice": {
                    "amount": 109,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "JYOJa2NpSCq",
                "title": "You Cant Be an Astrunaut!",
                "subtitle": "Its Just Not Realistic!",
                "authors": [
                    "Joseph Smets"
                ],
                "publishedDate": 1978,
                "description": "This book serves as a critique of the overly optimistic portrayal of space travel and astronautical pursuits, especially as depicted in popular media and science fiction. Using computer science and hacking as a backdrop, the author argues that the technical and realistic constraints often overlooked make the dream of becoming an astronaut far-fetched for the average person.",
                "pageCount": 129,
                "categories": [
                    "Family",
                    "Social Commentary",
                    "Science & Technology"
                ],
                "thumbnail": "14",
                "language": "en",
                "listPrice": {
                    "amount": 44,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "1y0Oqts35DQ",
                "title": "Between Here and Gone",
                "subtitle": "A Journey Through Love and Loss in the 60s",
                "authors": [
                    "Barbara Ferrer"
                ],
                "publishedDate": 2016,
                "description": "Set in the early 1960s, 'Between Here and Gone' is a novel that explores the complexities of love, loss, and identity. The story delves into relationships and the challenges associated with change and uncertainty.",
                "pageCount": 300,
                "categories": [
                    "Fiction",
                    "Historical Fiction",
                    "Romance"
                ],
                "thumbnail": "2",
                "language": "en",
                "listPrice": {
                    "amount": 108,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "kSnfIJyikTP",
                "title": "Beat Your Way to the Top",
                "subtitle": "Masturbation as a Technique For Business Success",
                "authors": [
                    "Dr. Stephen Larkin PhD"
                ],
                "publishedDate": 2012,
                "description": "After interviewing nearly 300 successful business people, both men and women, Dr. Larkin reveals their secret characteristics of business success, and describes a series of seven exercises that you can follow to assess and develop these characteristics in yourself. Warning: mild adult content.",
                "pageCount": 44,
                "categories": [
                    "Adult",
                    "Business",
                    "Personal Growth",
                    "Self Help"
                ],
                "thumbnail": "16",
                "language": "en",
                "listPrice": {
                    "amount": 30,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "f4iuVmbuKCC",
                "title": "Schisms",
                "subtitle": "Red World Trilogy Book 1",
                "authors": [
                    "V. A. Jeffrey"
                ],
                "publishedDate": 2012,
                "description": "An ancient prophecy has reappeared, one that promises the people deliverance from the rot of corruption that permeates the land. However, there are those who have no need of 'savior prophecies' which get in the way of the more pragmatic concerns of acquiring power.",
                "pageCount": 280,
                "categories": [
                    "Fantasy",
                    "Adventure",
                    "Politics & War",
                    "Moral & Ethics"
                ],
                "thumbnail": "12",
                "language": "en",
                "listPrice": {
                    "amount": 19,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "U2rfZO6oBZf",
                "title": "Gwent",
                "subtitle": "Art of The Witcher Card Game",
                "authors": [
                    "CD Projekt Red"
                ],
                "publishedDate": 2017,
                "description": "Whether played on the exotic felt tabletop in a palatial casino, or on the rough-hewn bar in a tavern's smoky din, the game of Gwent is never a dull one! With cards that feature fantastic art that only adds to the strategic thrill of crushing one's opponent, Gwent: The Witcher Card Game offers a singular gaming experience.",
                "pageCount": 216,
                "categories": [
                    "Fantasy",
                    "Games",
                    "Art"
                ],
                "thumbnail": "1",
                "language": "en",
                "listPrice": {
                    "amount": 91,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "xI0wrXaaAcq",
                "title": "Old Tractors and the Men Who Love Them",
                "subtitle": "How to Keep Your Tractors Happy and Your Family Running",
                "authors": [
                    "Roger Welsch"
                ],
                "publishedDate": 1995,
                "description": "This book caters to tractor enthusiasts, diving into the world of vintage tractors and the people who love them. It provides practical advice on maintenance and explores the culture and stories surrounding these beloved machines.",
                "pageCount": 160,
                "categories": [
                    "Automotives",
                    "Family",
                    "Practical Advice"
                ],
                "thumbnail": "15",
                "language": "en",
                "listPrice": {
                    "amount": 90,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "9laHCEdSpFy",
                "title": "Holes",
                "subtitle": "Digging Through the Desert of Despair",
                "authors": [
                    "Dr. Seuss"
                ],
                "publishedDate": 1984,
                "description": "In a barren desert, Jade is on a solitary mission: to dig holes, each one a potential doorway to redemption. With each shovelful of earth, she unearths not just soil but also the haunting secrets of her past. A lizard named Spirit becomes her unlikely companion in this desolate land. Spirit is more than just a reptile; it's a symbol of her own resilient spirit, a spirit that refuses to succumb to the harsh conditions surrounding her. As Jade digs deeper, both literally and metaphorically, she confronts both the dangers lurking below the surface and the despair threatening to consume her. 'Holes' is a gripping tale of one woman's quest for salvation, set against an unforgiving landscape that challenges her at every turn.",
                "pageCount": 352,
                "categories": [
                    "Adventure",
                    "Thriller",
                    "Fiction"
                ],
                "thumbnail": "11",
                "language": "en",
                "listPrice": {
                    "amount": 176,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "nGhVwZvGCGp",
                "title": "The Rise of the Russian Empire",
                "subtitle": "The Origins and Expansion of a Eurasian Power",
                "authors": [
                    "Hector Hugh Munro"
                ],
                "publishedDate": 2013,
                "description": 'This early work by H. H. Munro, also known as Saki, was originally published in 1900 and has been republished with a new introductory biography. Titled "The Rise of the Russian Empire," the book is a non-fiction account of Russian history. Munro was born in Burma in 1870 and raised in England by his aunts. He later joined the Colonial Burmese Military Police before returning to England to become a journalist. He gained fame for his satirical political sketches, "Alice in Westminster," published in the Westminster Gazette. Although he is better known for his masterful short stories like "The Open Window," this book represents his foray into historical writing.',
                "pageCount": 348,
                "categories": [
                    "History",
                    "Country Studies",
                    "Biography"
                ],
                "thumbnail": "10",
                "language": "en",
                "listPrice": {
                    "amount": 116,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "Q8Q9Lsd03BD",
                "title": "Unbored",
                "subtitle": "The Essential Field Guide to Serious Fun",
                "authors": [
                    "Joshua Glenn",
                    "Elizabeth Foy Larsen"
                ],
                "publishedDate": 2012,
                "description": "Unbored is a comprehensive guide aimed at inspiring children and families to break the routine and engage with the world in creative, educational, and adventurous ways. The book covers a vast array of activities, DIY projects, tips, and fun facts to keep everyone entertained and curious.",
                "pageCount": 352,
                "categories": [
                    "Family",
                    "DIY",
                    "Education"
                ],
                "thumbnail": "5",
                "language": "en",
                "listPrice": {
                    "amount": 145,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "bd7a76kARao",
                "title": "The Face in the Abyss",
                "subtitle": "A Serialized Fantasy Adventure",
                "authors": [
                    "A. Merritt"
                ],
                "publishedDate": 1978,
                "description": "'The Face in the Abyss' is a classic fantasy novel by A. Merritt, first serialized in a magazine before being published as a single volume. The story combines elements of adventure, mysticism, and fantasy, featuring a journey into an exotic, mythical landscape filled with ancient civilizations and mystical beings.",
                "pageCount": 158,
                "categories": [
                    "Fantasy",
                    "Adventure",
                    "Classic Literature",
                    "Fiction"
                ],
                "thumbnail": "13",
                "language": "en",
                "listPrice": {
                    "amount": 157,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "qKyG0vqeO3e",
                "title": "Don't Panic",
                "subtitle": "Douglas Adams & The Hitchhiker's Guide to the Galaxy",
                "authors": [
                    "Neil Gaiman"
                ],
                "publishedDate": 1988,
                "description": "Neil Gaiman's 'Don't Panic' is a companion guide to Douglas Adams' iconic 'Hitchhiker's Guide to the Galaxy' series. The book provides a behind-the-scenes look at the creation and enduring popularity of the series, including interviews, anecdotes, and insights into its creator, Douglas Adams.",
                "pageCount": 216,
                "categories": [
                    "Biography",
                    "Science Fiction",
                    "Pop Culture"
                ],
                "thumbnail": "17",
                "language": "en",
                "listPrice": {
                    "amount": 57,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "2RvT48ZNInj",
                "title": "The Ode Less Travelled",
                "subtitle": "Unlocking the Poet Within",
                "authors": [
                    "Stephen Fry"
                ],
                "publishedDate": 2005,
                "description": "Stephen Fry's 'The Ode Less Travelled' serves as a comprehensive guide to writing poetry. It demystifies various poetic forms, meters, and techniques, offering readers exercises to hone their skills. The book aims to unlock the poet within anyone who is interested but may find poetry intimidating.",
                "pageCount": 384,
                "categories": [
                    "Poetry",
                    "Creative Writing",
                    "Education"
                ],
                "thumbnail": "8",
                "language": "en",
                "listPrice": {
                    "amount": 167,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "5z2s9pDXAYj",
                "title": "Magic Lantern",
                "subtitle": "Part 3 of The Triskell Story",
                "authors": [
                    "Danielle Steel"
                ],
                "publishedDate": 2014,
                "description": "Tara Ruane and her security adviser Robert Grainger effect a dramatic escape from the criminal gang lead by Pascal de Waverin-Looz, a rich, ruthless psychopath and Celtic revivalist, only to find themselves accused of yet another atrocity committed by Pascal. He is bent upon claiming all the parts of the Triskell, for its magical capacity to read the future. Tara and Robert are now the focus of pursuit by both Pascal and the French police. The game changes when Tara’s young niece, Aoife, is kidnapped by Pascal’s girlfriend and Tara realises she must bargain with Pascal for Aoife’s safety, even if this means her death.",
                "pageCount": 302,
                "categories": [
                    "Thriller",
                    "Fantasy",
                    "Crime",
                    "Supernatural"
                ],
                "thumbnail": "3",
                "language": "en",
                "listPrice": {
                    "amount": 150,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "zBZu5cDEWha",
                "title": "Book Title",
                "subtitle": "A Placeholder Journey",
                "authors": [
                    "Author's Name"
                ],
                "publishedDate": 2023,
                "description": "In 'Book Title,' Author's Name takes readers on an unforgettable journey through a fictional landscape. As a placeholder text, the book could belong to any genre and explore any theme, from the depths of human emotion to the intricacies of a high-stakes thriller. Until further details are revealed, this remains a book of limitless possibilities.",
                "pageCount": 10,
                "categories": [
                    "Unknown",
                    "Mystery"
                ],
                "thumbnail": "6",
                "language": "en",
                "listPrice": {
                    "amount": 58,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "aOI7tQuPZ2f",
                "title": "The Sith Empire will Rise again and we are the spark",
                "subtitle": "Igniting the Galaxy's Last Hope",
                "authors": [
                    "Author 1 (Star Wars Lore Expert)",
                    "Author 2 (Political/Adventure Storyteller)"
                ],
                "publishedDate": 2023,
                "description": "In a galaxy torn apart by war and deceit, remnants of the Sith Empire have been hiding in the shadows, biding their time to strike back and reclaim their former glory. Amidst this brewing storm, a small group of rebels, self-dubbed 'the spark,' decide to take matters into their own hands. United by a common enemy, they must navigate betrayal, ancient prophecies, and their own inner demons to ignite a revolution that could either save the galaxy or plunge it into further darkness.",
                "pageCount": 461,
                "categories": [
                    "Science Fiction",
                    "Fantasy",
                    "Adventure",
                    "Thriller"
                ],
                "thumbnail": "7",
                "language": "en",
                "listPrice": {
                    "amount": 78,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "WBooB82Uvwu",
                "title": "How to Defend Yourself Against Alien Abduction",
                "subtitle": "Strategies for Avoiding Extraterrestrial Kidnapping",
                "authors": [
                    "Ann Druffel"
                ],
                "publishedDate": 1998,
                "description": "In 1988 Ann Druffel, who has researched UFOs for forty years, discovered a little-known fact that had been drowned in abduction hysteria—documented evidence that people have successfully fended off attack by the “greys,” the short, big-eyed aliens now familiar through so much popular media. Using her database of 250 case studies, including seventy “resisters,” Druffel has ascertained nine techniques that witnesses use to ward off alien entities and even break off abductions in progress. And perhaps even more astonishing, this evidence points to the possible true identity of the greys and their link to the abducting entities of myth and folklore.",
                "pageCount": 260,
                "categories": [
                    "Paranormal",
                    "Self Help",
                    "Speculative Non-Fiction"
                ],
                "thumbnail": "18",
                "language": "en",
                "listPrice": {
                    "amount": 118,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "xm1z5bbZjlS",
                "title": "The Unsung Hero",
                "subtitle": "A Contemporary Romance",
                "authors": [
                    "Samantha James"
                ],
                "publishedDate": 1986,
                "description": "Samantha Monroe planned to spend the summer swept away in a world of fantasy created by her favorite romance author. Then one day a real live fantasy man appeared before her on the beach.",
                "pageCount": 175,
                "categories": [
                    "Romance",
                    "Fiction",
                    "Fantasy"
                ],
                "thumbnail": "9",
                "language": "en",
                "listPrice": {
                    "amount": 60,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "u3j6QIKLlJb",
                "title": "It's Just a Dog",
                "subtitle": "A Tale of Love, Loss, and Canine Connection",
                "authors": [
                    "Russ Ryan"
                ],
                "publishedDate": 2013,
                "description": "In 'It's Just a Dog,' the protagonist faces emotional upheaval after the loss of his beloved canine companion. As he navigates through his grief, he starts to believe that his dog is communicating with him from the afterlife, leading him on a journey of healing and self-discovery.",
                "pageCount": 190,
                "categories": [
                    "Fiction",
                    "Pets",
                    "Psychological Thriller"
                ],
                "thumbnail": "4",
                "language": "en",
                "listPrice": {
                    "amount": 110,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "vxYYYdVlEH3",
                "title": "How to Start Your Own Country",
                "subtitle": "A Comprehensive Guide to Establishing a Micronation",
                "authors": [
                    "Erwin S. Strauss"
                ],
                "publishedDate": 1984,
                "description": "In 'How to Start Your Own Country,' Erwin S. Strauss provides a detailed guide to creating a micronation. The book explores the complexities, legalities, and practicalities of establishing a new sovereign state, and it covers a variety of methods for doing so.",
                "pageCount": 170,
                "categories": [
                    "Political Science",
                    "Law",
                    "Sovereignty"
                ],
                "thumbnail": "19",
                "language": "en",
                "listPrice": {
                    "amount": 186,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "dV9aW8sO3Fq",
                "title": "Cien Años de Soledad",
                "subtitle": "Una Historia de la Familia Buendía",
                "authors": [
                    "Gabriel García Márquez"
                ],
                "publishedDate": 1967,
                "description": "An epic tale that spans seven generations of the Buendía family in the fictional town of Macondo.",
                "pageCount": 417,
                "categories": [
                    "Fiction",
                    "Magical Realism",
                    "Latino Literature"
                ],
                "thumbnail": "21",
                "language": "es",
                "listPrice": {
                    "amount": 126,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "R6oH9sH2aLm",
                "title": "El Amor en los Tiempos del Cólera",
                "subtitle": "Una Historia de Amor Perseverante",
                "authors": [
                    "Gabriel García Márquez"
                ],
                "publishedDate": 1985,
                "description": "Explores the theme of love through the story of a couple who wait over half a lifetime to be together.",
                "pageCount": 348,
                "categories": [
                    "Fiction",
                    "Romance",
                    "Latino Literature"
                ],
                "thumbnail": "22",
                "language": "es",
                "listPrice": {
                    "amount": 226,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "S0mE9sT6xAp",
                "title": "Don Quijote de la Mancha",
                "subtitle": "La Aventura de un Caballero Andante",
                "authors": [
                    "Miguel de Cervantes Saavedra"
                ],
                "publishedDate": 1615,
                "description": "The adventures of a man who becomes a knight-errant and sets out to right the world's wrongs.",
                "pageCount": 1023,
                "categories": [
                    "Classic Literature",
                    "Adventure"
                ],
                "thumbnail": "23",
                "language": "es",
                "listPrice": {
                    "amount": 106,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "L2kZ9tP5dCs",
                "title": "War And Peace",
                "subtitle": "An Epic of Russian History",
                "authors": [
                    "Lev Tolstoy"
                ],
                "publishedDate": 1869,
                "description": "An epic tale of society during the Napoleonic Wars.",
                "pageCount": 1225,
                "categories": [
                    "Fiction",
                    "Historical Fiction",
                    "Adventure",
                    "Russian Literature"
                ],
                "thumbnail": "24",
                "language": "ru",
                "listPrice": {
                    "amount": 86,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "D8vY2mX9bZt",
                "title": "Crime and Punishment",
                "subtitle": "Psychological Novel",
                "authors": [
                    "Fyodor Dostoyevsky"
                ],
                "publishedDate": 1866,
                "description": "A young man grapples with morality after committing a murder for philosophical reasons.",
                "pageCount": 671,
                "categories": [
                    "Fiction",
                    "Psychological Thriller",
                    "Thriller",
                    "Russian Literature"
                ],
                "thumbnail": "25",
                "language": "ru",
                "listPrice": {
                    "amount": 151,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "E5zQ6oU7vHx",
                "title": "The Master and Margarita",
                "subtitle": "A Mystical Novel",
                "authors": [
                    "Mikhail Bulgakov"
                ],
                "publishedDate": 1967,
                "description": "A visit by the Devil to the atheistic Soviet Union reveals human follies and societal issues.",
                "pageCount": 384,
                "categories": [
                    "Fiction",
                    "Fantasy",
                    "Russian Literature"
                ],
                "thumbnail": "26",
                "language": "ru",
                "listPrice": {
                    "amount": 91,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "G4hP9lK8aZr",
                "title": "Die Blechtrommel",
                "subtitle": "Ein Roman der Nachkriegszeit",
                "authors": [
                    "Günter Grass"
                ],
                "publishedDate": 1959,
                "description": "A story that follows the life of Oskar Matzerath, who decides to stop growing at the age of three as a protest against the absurdity of life.",
                "pageCount": 732,
                "categories": [
                    "Fiction",
                    "Historical Fiction",
                    "German Literature"
                ],
                "thumbnail": "27",
                "language": "de",
                "listPrice": {
                    "amount": 91,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            },
            {
                "id": "Y2sH7oD4pFw",
                "title": "Faust",
                "subtitle": "Eine Tragödie",
                "authors": [
                    "Johann Wolfgang von Goethe"
                ],
                "publishedDate": 1808,
                "description": "The tragic story of Dr. Faustus, a man who sells his soul to the devil for power and knowledge.",
                "pageCount": 497,
                "categories": [
                    "Classics",
                    "Drama",
                    "Fantasy"
                ],
                "thumbnail": "28",
                "language": "de",
                "listPrice": {
                    "amount": 131,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "H3zV9pX8mJq",
                "title": "Der Steppenwolf",
                "subtitle": "Ein psychologischer Roman",
                "authors": [
                    "Hermann Hesse"
                ],
                "publishedDate": 1927,
                "description": "A novel that delves into the psyche of a man torn between his human and wolf-like desires.",
                "pageCount": 237,
                "categories": [
                    "Fiction",
                    "Psychological Fiction",
                    "German Literature"
                ],
                "thumbnail": "29",
                "language": "de",
                "listPrice": {
                    "amount": 211,
                    "currencyCode": "USD",
                    "isOnSale": false
                }
            },
            {
                "id": "B8zT2lW5nOs",
                "title": "Das Parfum",
                "subtitle": "Die Geschichte eines Mörders",
                "authors": [
                    "Patrick Süskind"
                ],
                "publishedDate": 1985,
                "description": "The story of a man with no body odor himself, but a highly developed sense of smell, and his quest to create the world's finest perfume.",
                "pageCount": 263,
                "categories": [
                    "Fiction",
                    "Thriller",
                    "German Literature"
                ],
                "thumbnail": "30",
                "language": "de",
                "listPrice": {
                    "amount": 111,
                    "currencyCode": "USD",
                    "isOnSale": true
                }
            }
        ]
        utilService.saveToStorage(BOOK_KEY, books)
    }
}

function createBook(title, subtitle, authors, publishedDate, description, pageCount
    , categories, thumbnail = "6", language, amount, currencyCode = 'USD', isOnSale = false) {
    const newBook = {
        id: utilService.makeId(),
        title,
        subtitle,
        authors,
        publishedDate,
        description,
        pageCount,
        categories,
        thumbnail,
        language,
        listPrice: {
            amount,
            currencyCode,
            isOnSale
        }
    }
    return storageService.post(BOOK_KEY, newBook)
        .then(savedBook => {
            return savedBook
        })
}